<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta
      name="description"
      content="Single-page global market dashboard with live TradingView and FRED embeds for stocks, bonds, currencies, and commodities."
    />
    <title>Global Market Dashboard</title>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="style.css" />
  </head>
  <body>
    <a class="skip-link" href="#main-content">Skip to main content</a>
    <header class="top-bar">
      <div class="brand">üåç Global Market Dashboard</div>
      <button
        class="menu-toggle"
        type="button"
        aria-label="Toggle navigation"
        aria-expanded="false"
        aria-controls="primary-navigation"
      >
        <span></span>
        <span></span>
        <span></span>
      </button>
      <nav class="nav-links" id="primary-navigation" aria-label="Section navigation">
        <ul>
          <li><a href="#stocks">Stocks</a></li>
          <li><a href="#bonds">Bonds</a></li>
          <li><a href="#currencies">Currencies</a></li>
          <li><a href="#commodities">Commodities</a></li>
          <li><a href="#timeline">Macro Timeline</a></li>
        </ul>
      </nav>
    </header>

    <main id="main-content">
      <section class="intro">
        <p>
          A lightweight personal market observatory featuring interactive TradingView charts and FRED data embeds.
          Zoom, pan, and study each chart without leaving the dashboard, then dive into the macro timeline for upcoming
          catalysts.
        </p>
      </section>

      <section id="stocks" class="dashboard-section">
        <div class="section-header">
          <h2>Stock Markets</h2>
          <p>Major equity benchmarks across the U.S. and Asia.</p>
        </div>
        <div class="cards-grid">
          <article class="card">
            <div class="card-header">
              <h3>S&amp;P 500 (SPY)</h3>
              <p>ETF proxy tracking the benchmark U.S. equities index.</p>
            </div>
            <div class="card-body">
              <div class="tradingview-widget-container card-chart">
                <div
                  id="tv-spx"
                  class="chart-container"
                  data-tv-symbol="AMEX:SPY"
                  data-tv-range="12M"
                  aria-label="Interactive price chart for the SPDR S&amp;P 500 ETF"
                ></div>
              </div>
            </div>
            <div class="card-footer">
              <a
                class="card-link"
                href="https://www.tradingview.com/symbols/AMEX-SPY/"
                target="_blank"
                rel="noopener noreferrer"
              >
                Open on TradingView
              </a>
            </div>
          </article>

          <article class="card">
            <div class="card-header">
              <h3>NASDAQ</h3>
              <p>Growth and tech-heavy U.S. composite.</p>
            </div>
            <div class="card-body">
              <div class="tradingview-widget-container card-chart">
                <div
                  id="tv-nasdaq"
                  class="chart-container"
                  data-tv-symbol="NASDAQ:IXIC"
                  data-tv-range="12M"
                  aria-label="Interactive price chart for the NASDAQ Composite"
                ></div>
              </div>
            </div>
            <div class="card-footer">
              <a
                class="card-link"
                href="https://www.tradingview.com/symbols/NASDAQ-IXIC/"
                target="_blank"
                rel="noopener noreferrer"
              >
                Open on TradingView
              </a>
            </div>
          </article>

          <article class="card">
            <div class="card-header">
              <h3>Taiwan Weighted Index</h3>
              <p>Semiconductor-led performance barometer.</p>
            </div>
            <div class="card-body">
              <div class="tradingview-widget-container card-chart">
                <div
                  id="tv-taiex"
                  class="chart-container"
                  data-tv-symbol="TWSE:TAIEX"
                  data-tv-range="12M"
                  aria-label="Interactive price chart for the Taiwan Weighted Index"
                ></div>
              </div>
            </div>
            <div class="card-footer">
              <a
                class="card-link"
                href="https://www.tradingview.com/symbols/TWSE-TAIEX/"
                target="_blank"
                rel="noopener noreferrer"
              >
                Open on TradingView
              </a>
            </div>
          </article>
        </div>
      </section>

      <section id="bonds" class="dashboard-section">
        <div class="section-header">
          <h2>U.S. Treasury Yield</h2>
          <p>FRED 10-year constant maturity treasury rate.</p>
        </div>
        <div class="cards-grid single">
          <article class="card">
            <div class="card-header">
              <h3>US Treasury 10Y</h3>
              <p>Macro benchmark for global discount rates.</p>
            </div>
            <div class="card-body">
              <div class="iframe-wrapper">
                <iframe
                  title="10-Year Treasury Constant Maturity Rate"
                  src="https://fred.stlouisfed.org/graph/fredgraph.html?id=DGS10&cosd=2010-01-01&height=300"
                  scrolling="no"
                  frameborder="0"
                  loading="lazy"
                  referrerpolicy="no-referrer-when-downgrade"
                ></iframe>
              </div>
            </div>
            <div class="card-footer">
              <a
                class="card-link"
                href="https://fred.stlouisfed.org/series/DGS10"
                target="_blank"
                rel="noopener noreferrer"
              >
                View full series on FRED
              </a>
            </div>
          </article>
        </div>
      </section>

      <section id="currencies" class="dashboard-section">
        <div class="section-header">
          <h2>Currencies</h2>
          <p>Dollar strength vs. broad basket and the Japanese yen.</p>
        </div>
        <div class="cards-grid">
          <article class="card">
            <div class="card-header">
              <h3>US Dollar Index (DXY)</h3>
              <p>Measures USD against a major currency basket.</p>
            </div>
            <div class="card-body">
              <div class="tradingview-widget-container card-chart">
                <div
                  id="tv-dxy"
                  class="chart-container"
                  data-tv-symbol="TVC:DXY"
                  data-tv-range="12M"
                  aria-label="Interactive price chart for the US Dollar Index"
                ></div>
              </div>
            </div>
            <div class="card-footer">
              <a
                class="card-link"
                href="https://www.tradingview.com/symbols/TVC-DXY/"
                target="_blank"
                rel="noopener noreferrer"
              >
                Open on TradingView
              </a>
            </div>
          </article>

          <article class="card">
            <div class="card-header">
              <h3>USD / JPY</h3>
              <p>Key rate for global carry and risk sentiment.</p>
            </div>
            <div class="card-body">
              <div class="tradingview-widget-container card-chart">
                <div
                  id="tv-usdjpy"
                  class="chart-container"
                  data-tv-symbol="FX:USDJPY"
                  data-tv-range="12M"
                  aria-label="Interactive price chart for the USD/JPY exchange rate"
                ></div>
              </div>
            </div>
            <div class="card-footer">
              <a
                class="card-link"
                href="https://www.tradingview.com/symbols/FX-USDJPY/"
                target="_blank"
                rel="noopener noreferrer"
              >
                Open on TradingView
              </a>
            </div>
          </article>
        </div>
      </section>

      <section id="commodities" class="dashboard-section">
        <div class="section-header">
          <h2>Commodities</h2>
          <p>Energy and precious metals benchmarks.</p>
        </div>
        <div class="cards-grid">
          <article class="card">
            <div class="card-header">
              <h3>WTI Crude Oil</h3>
              <p>Gauge for global growth and inflation pressures.</p>
            </div>
            <div class="card-body">
              <div class="tradingview-widget-container card-chart">
                <div
                  id="tv-usoil"
                  class="chart-container"
                  data-tv-symbol="TVC:USOIL"
                  data-tv-range="12M"
                  aria-label="Interactive price chart for WTI crude oil"
                ></div>
              </div>
            </div>
            <div class="card-footer">
              <a
                class="card-link"
                href="https://www.tradingview.com/symbols/TVC-USOIL/"
                target="_blank"
                rel="noopener noreferrer"
              >
                Open on TradingView
              </a>
            </div>
          </article>

          <article class="card">
            <div class="card-header">
              <h3>Gold</h3>
              <p>Store of value and macro hedge signal.</p>
            </div>
            <div class="card-body">
              <div class="tradingview-widget-container card-chart">
                <div
                  id="tv-gold"
                  class="chart-container"
                  data-tv-symbol="TVC:GOLD"
                  data-tv-range="12M"
                  aria-label="Interactive price chart for gold"
                ></div>
              </div>
            </div>
            <div class="card-footer">
              <a
                class="card-link"
                href="https://www.tradingview.com/symbols/TVC-GOLD/"
                target="_blank"
                rel="noopener noreferrer"
              >
                Open on TradingView
              </a>
            </div>
          </article>
        </div>
        <ol class="timeline" aria-label="Upcoming macroeconomic events"></ol>
      </section>

      <section id="timeline" class="dashboard-section timeline-section">
        <div class="section-header">
          <h2>Global Macro Timeline</h2>
          <p>Upcoming policy decisions and economic events that move markets.</p>
        </div>
        <ol class="timeline" aria-label="Upcoming macroeconomic events"></ol>
      </section>
    </main>

    <footer class="site-footer">
      <p>
        Data and charts are provided by their respective platforms. This dashboard is for informational purposes only.
      </p>
    </footer>

    <script src="https://s3.tradingview.com/tv.js"></script>
    <script>
      document.addEventListener("DOMContentLoaded", () => {
        const menuToggle = document.querySelector(".menu-toggle");
        const nav = document.querySelector(".nav-links");
        const navLinks = nav.querySelectorAll("a");

        const closeMenu = () => {
          nav.classList.remove("open");
          menuToggle.setAttribute("aria-expanded", "false");
        };

        menuToggle.addEventListener("click", () => {
          const isOpen = nav.classList.toggle("open");
          menuToggle.setAttribute("aria-expanded", String(isOpen));
        });

        navLinks.forEach((link) => {
          link.addEventListener("click", () => {
            if (window.matchMedia("(max-width: 720px)").matches) {
              closeMenu();
            }
          });
        });

        window.addEventListener("keydown", (event) => {
          if (event.key === "Escape") {
            closeMenu();
          }
        });

        const tradingViewContainers = document.querySelectorAll(".chart-container[data-tv-symbol]");

        if (window.TradingView) {
          tradingViewContainers.forEach((container) => {
            const symbol = container.dataset.tvSymbol;
            if (!symbol || !container.id) {
              return;
            }

            new TradingView.widget({
              autosize: true,
              symbol,
              interval: container.dataset.tvInterval || "D",
              timezone: container.dataset.tvTimezone || "Etc/UTC",
              theme: "light",
              style: "1",
              locale: "en",
              toolbar_bg: "#f1f3f6",
              enable_publishing: false,
              allow_symbol_change: false,
              hide_side_toolbar: true,
              withdateranges: true,
              range: container.dataset.tvRange || "12M",
              support_host: "https://www.tradingview.com",
              container_id: container.id,
            });
          });
        } else if (tradingViewContainers.length) {
          tradingViewContainers.forEach((container) => {
            container.classList.add("chart-unavailable");
            container.innerHTML =
              '<p class="chart-fallback">TradingView charts are unavailable right now. Please refresh the page.</p>';
          });
        }

        const timelineEvents = [
          {
            date: "18 Sep 2024",
            title: "FOMC interest rate decision",
            description: "Federal Reserve updates its policy rate and releases a fresh Summary of Economic Projections.",
            tag: "Monetary Policy",
          },
          {
            date: "10 Oct 2024",
            title: "US CPI release (September)",
            description: "Inflation print will guide expectations for year-end rate policy and Treasury yield direction.",
            tag: "Inflation",
          },
          {
            date: "24 Oct 2024",
            title: "ECB Governing Council meeting",
            description: "Eurozone rate guidance and balance sheet commentary set the tone for EUR crosses.",
            tag: "Central Banks",
          },
          {
            date: "05 Nov 2024",
            title: "U.S. presidential election",
            description: "Outcome shapes fiscal policy, trade stance, and sector leadership for 2025.",
            tag: "Political",
          },
          {
            date: "03 Dec 2024",
            title: "OPEC+ policy meeting",
            description: "Oil supply targets and forward guidance influence energy prices and inflation expectations.",
            tag: "Energy",
          },
          {
            date: "21 Jan 2025",
            title: "World Economic Forum annual meeting",
            description: "Global leaders converge in Davos to discuss growth outlooks and investment priorities.",
            tag: "Global Summit",
          },
        ];

        const timelineList = document.querySelector(".timeline");
        if (timelineList) {
          const fragment = document.createDocumentFragment();
          timelineEvents.forEach((event) => {
            const item = document.createElement("li");

            const date = document.createElement("div");
            date.className = "timeline-date";
            date.textContent = event.date;

            const content = document.createElement("div");
            content.className = "timeline-content";

            const title = document.createElement("h3");
            title.textContent = event.title;

            const description = document.createElement("p");
            description.textContent = event.description;

            content.append(title, description);

            if (event.tag) {
              const tag = document.createElement("span");
              tag.className = "event-tag";
              tag.textContent = event.tag;
              content.appendChild(tag);
            }

            item.append(date, content);
            fragment.appendChild(item);
          });

          timelineList.appendChild(fragment);
        }

        const timelineList = document.querySelector(".timeline");
        const timelineSection = document.querySelector(".timeline-section");

        const renderTimelineStatus = (message, type = "status") => {
          if (!timelineList) {
            return;
          }

          timelineList.innerHTML = "";
          const statusItem = document.createElement("li");
          statusItem.className = `timeline-${type}`;
          statusItem.textContent = message;
          timelineList.appendChild(statusItem);
        };

        const formatDisplayDate = (date) =>
          date.toLocaleString(undefined, {
            month: "short",
            day: "numeric",
            hour: "numeric",
            minute: "2-digit",
          });

        const normaliseTime = (value) => {
          if (!value) {
            return "00:00:00";
          }

          if (/^\d{2}:\d{2}$/.test(value)) {
            return `${value}:00`;
          }

          return value;
        };

        const parseEventDate = (event) => {
          if (!event || !event.date) {
            return null;
          }

          const [datePart, timePart] = event.date.split(" ");
          const baseDate = datePart || event.date;
          const time = event.time ? normaliseTime(event.time) : normaliseTime(timePart);

          const isoCandidate = `${baseDate}T${time || "00:00:00"}`;

          const utcCandidate = Date.parse(`${isoCandidate}Z`);
          if (!Number.isNaN(utcCandidate)) {
            return new Date(utcCandidate);
          }

          const localCandidate = Date.parse(isoCandidate);
          if (!Number.isNaN(localCandidate)) {
            return new Date(localCandidate);
          }

          return null;
        };

        const buildTimelineItem = (event) => {
          const item = document.createElement("li");

          const eventDate = parseEventDate(event);
          const dateElement = document.createElement("div");
          dateElement.className = "timeline-date";
          if (eventDate) {
            dateElement.textContent = formatDisplayDate(eventDate);
          } else {
            dateElement.textContent = event.date || "Upcoming";
          }

          const content = document.createElement("div");
          content.className = "timeline-content";

          const title = document.createElement("h3");
          title.textContent = event.event || event.title || "Economic release";

          const details = document.createElement("p");
          const info = [];
          if (event.country) {
            info.push(event.country);
          }
          if (event.importance) {
            info.push(event.importance);
          }
          if (event.category && !event.importance) {
            info.push(event.category);
          }
          if (event.consensus != null) {
            info.push(`Forecast: ${event.consensus}`);
          }
          if (event.actual != null) {
            info.push(`Actual: ${event.actual}`);
          }
          if (event.previous != null) {
            info.push(`Previous: ${event.previous}`);
          }

          if (info.length) {
            details.textContent = info.join(" ‚Ä¢ ");
          } else if (event.description) {
            details.textContent = event.description;
          } else {
            details.textContent = "Upcoming economic data";
          }

          content.append(title, details);

          const tagValue = event.importance || event.category || "";
          if (tagValue) {
            const tag = document.createElement("span");
            tag.className = "event-tag";
            tag.textContent = tagValue;
            content.appendChild(tag);
          }

          item.append(dateElement, content);
          return { item, eventDate };
        };

        const fallbackEvents = [
          {
            date: new Date().toISOString(),
            title: "FOMC press conference",
            description: "Federal Reserve chair provides color on the latest policy decision.",
            category: "Monetary Policy",
          },
          {
            date: new Date(Date.now() + 2 * 24 * 60 * 60 * 1000).toISOString(),
            title: "US Nonfarm Payrolls",
            description: "Employment data that often swings risk sentiment and USD crosses.",
            category: "Labor Market",
          },
          {
            date: new Date(Date.now() + 4 * 24 * 60 * 60 * 1000).toISOString(),
            title: "Eurozone CPI Flash",
            description: "Inflation snapshot guiding ECB expectations.",
            category: "Inflation",
          },
        ];

        const loadEconomicCalendar = async () => {
          if (!timelineList) {
            return;
          }

          renderTimelineStatus("Loading upcoming releases‚Ä¶");

          const now = new Date();
          const formatDateParam = (date) => date.toISOString().split("T")[0];
          const start = formatDateParam(now);
          const end = formatDateParam(new Date(now.getTime() + 7 * 24 * 60 * 60 * 1000));
          const calendarEndpoint =
            "https://financialmodelingprep.com/api/v3/economic_calendar" +
            `?from=${start}&to=${end}&apikey=demo`;

          try {
            const response = await fetch(calendarEndpoint);
            if (!response.ok) {
              throw new Error(`Request failed with status ${response.status}`);
            }

            const payload = await response.json();
            if (!Array.isArray(payload) || payload.length === 0) {
              throw new Error("No upcoming events");
            }

            const upcoming = payload
              .map((event) => {
                const { item, eventDate } = buildTimelineItem(event);
                return { item, eventDate };
              })
              .filter(({ eventDate }) => eventDate && eventDate.getTime() >= now.getTime())
              .sort((a, b) => a.eventDate - b.eventDate)
              .slice(0, 10);

            timelineList.innerHTML = "";

            if (!upcoming.length) {
              renderTimelineStatus("No upcoming releases in the next few days.");
              return;
            }

            const fragment = document.createDocumentFragment();
            upcoming.forEach(({ item }) => fragment.appendChild(item));
            timelineList.appendChild(fragment);

            if (timelineSection) {
              timelineSection.setAttribute(
                "data-calendar-source",
                "financialmodelingprep.com/api/v3/economic_calendar"
              );
            }
          } catch (error) {
            renderTimelineStatus(
              "Unable to load live economic releases right now. Please try again later.",
              "error"
            );
            if (timelineSection) {
              timelineSection.setAttribute("data-calendar-error", String(error));
            }

            const fragment = document.createDocumentFragment();
            fallbackEvents.forEach((event) => {
              const { item } = buildTimelineItem(event);
              fragment.appendChild(item);
            });
            timelineList.appendChild(fragment);
          }
        };

        loadEconomicCalendar();
      });
    </script>
  </body>
</html>
